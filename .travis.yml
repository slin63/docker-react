language: generic

# Enable root
sudo: required

# What binaries to load
services:
  - docker

before_install:
  - docker build -t knoppers412/docker-react -f Dockerfile.dev .

# CI=true => tests will only run once instead of launching the watcher.
script:
  - docker run -e CI=true knoppers412/docker-react npm run test

deploy:
  # Travis is preconfigured to handle certain providers, so we can
  # just explicitly pass it elasticbeanstalk
  provider: elasticbeanstalk

  # AWS deploy region
  region: "us-east-2"

  # The actual application name of the thing
  app: "docker-react"

  # The actual environment name of the thing
  env: "DockerReact-env"

  # S3 bucket name that was generated by elastic beanstalk
  bucket_name: "elasticbeanstalk-us-east-1-961171806715"

  # Path to deploy to
  bucket_path: "docker-react"

  # Specify what branch to deploy
  on:
    branch: master

  # AWS Keys
  access_key_id: $AWS_ACCESS_KEY
  secret_access_key: $AWS_SECRET_KEY

